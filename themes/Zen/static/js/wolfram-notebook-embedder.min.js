!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.WolframNotebookEmbedder={})}(this,function(e){"use strict";var t=setTimeout;function r(){}function i(e){if(!(this instanceof i))throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],s(e,this)}function o(n,r){for(;3===n._state;)n=n._value;0!==n._state?(n._handled=!0,i._immediateFn(function(){var e=1===n._state?r.onFulfilled:r.onRejected;if(null!==e){var t;try{t=e(n._value)}catch(e){return void c(r.promise,e)}u(r.promise,t)}else(1===n._state?u:c)(r.promise,n._value)})):n._deferreds.push(r)}function u(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var n=e.then;if(e instanceof i)return t._state=3,t._value=e,void f(t);if("function"==typeof n)return void s((r=n,o=e,function(){r.apply(o,arguments)}),t)}t._state=1,t._value=e,f(t)}catch(e){c(t,e)}var r,o}function c(e,t){e._state=2,e._value=t,f(e)}function f(e){2===e._state&&0===e._deferreds.length&&i._immediateFn(function(){e._handled||i._unhandledRejectionFn(e._value)});for(var t=0,n=e._deferreds.length;t<n;t++)o(e,e._deferreds[t]);e._deferreds=null}function a(e,t,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=n}function s(e,t){var n=!1;try{e(function(e){n||(n=!0,u(t,e))},function(e){n||(n=!0,c(t,e))})}catch(e){if(n)return;n=!0,c(t,e)}}i.prototype.catch=function(e){return this.then(null,e)},i.prototype.then=function(e,t){var n=new this.constructor(r);return o(this,new a(e,t,n)),n},i.prototype.finally=function(t){var n=this.constructor;return this.then(function(e){return n.resolve(t()).then(function(){return e})},function(e){return n.resolve(t()).then(function(){return n.reject(e)})})},i.all=function(t){return new i(function(r,o){if(!t||void 0===t.length)throw new TypeError("Promise.all accepts an array");var i=Array.prototype.slice.call(t);if(0===i.length)return r([]);var u=i.length;function c(t,e){try{if(e&&("object"==typeof e||"function"==typeof e)){var n=e.then;if("function"==typeof n)return void n.call(e,function(e){c(t,e)},o)}i[t]=e,0==--u&&r(i)}catch(e){o(e)}}for(var e=0;e<i.length;e++)c(e,i[e])})},i.resolve=function(t){return t&&"object"==typeof t&&t.constructor===i?t:new i(function(e){e(t)})},i.reject=function(n){return new i(function(e,t){t(n)})},i.race=function(o){return new i(function(e,t){for(var n=0,r=o.length;n<r;n++)o[n].then(e,t)})},i._immediateFn="function"==typeof setImmediate&&function(e){setImmediate(e)}||function(e){t(e,0)},i._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)};var l=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw new Error("Unable to locate global object")}().Promise||i,n={},d={},h=0;function p(e){if(!n[e]){var t=document.createElement("script");t.type="text/javascript",t.src=e,document.getElementsByTagName("head")[0].appendChild(t),n[e]=!0}}function v(e,t){return void 0===e?t:e}e.embed=function(e,t,n){var u,r=n||{};return l.resolve().then(function(){return function(e){var t=function(e,t){for(var n=null,r=null,o=0;o<t.length;++o){var i=t[o],u=e.indexOf(i);0<=u&&(null===n||u<n.length)&&(n=e.substring(0,u),r=e.substring(u+i.length))}return[n,r]}(e,["/obj/","/objects/"]),i=t[0],n=t[1];if(!i||!n)throw new Error("InvalidCloudObjectURL");var u=i+"/notebooks/embedding?path="+n;return new l(function(n,r){var o=new XMLHttpRequest;o.addEventListener("load",function(){if(200===o.status){var e=o.responseText,t=JSON.parse(e);n({notebookID:t.notebookID,mainScript:i+t.mainScript,otherScripts:(t.otherScripts||[]).map(function(e){return i+e})})}else r(new Error("ResolveError"))}),o.addEventListener("error",function(){r(new Error("RequestError"))}),o.addEventListener("abort",function(){r(new Error("RequestAborted"))}),o.open("GET",u),o.send()})}(e)}).then(function(e){var o,t=e.notebookID,n=e.mainScript,r=e.otherScripts;u=t;for(var i=0;i<r.length;++i)p(r[i]);return d[o=n]||(d[o]=new l(function(t,e){var n,r=document.createElement("script");for(r.type="text/javascript",r.onerror=e;n="_wolframNotebookEmbedderCallback"+ ++h,window[n];);window[n]=function(e){delete window[n],t(e)},r.src=o+"?callback="+n,document.getElementsByTagName("head")[0].appendChild(r)})),d[o]}).then(function(e){return e.embed(u,t,{width:v(r.width,null),maxHeight:v(r.maxHeight,1/0),allowInteract:v(r.allowInteract,!0),showRenderProgress:v(r.showRenderProgress,!0)})})},Object.defineProperty(e,"__esModule",{value:!0})});